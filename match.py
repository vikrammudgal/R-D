import re
from collections import defaultdict
from rapidfuzz import fuzz
import ahocorasick

# ---------------------------
# 1. Keyword dictionary
# ---------------------------
keywords = {
    "LedgerGroups": ['Current Assets','Indirect Expenses','Loans (Liability)','Branch / Divisions','Capital Account','Current Liabilities','Direct Expenses','Direct Incomes','Fixed Assets','Sales Accounts','Indirect Incomes','Investments','Misc. Expenses (ASSET)','Purchase Accounts','Suspense A/c','Bank Accounts','Cash-in-Hand','Deposits (Asset)','Loans & Advances (Asset)','Staff Advances','Stock-in-Hand','Sundry Debtors','Travel Advances','Bank Charges & Interest','Internet & Website Charges','Others','Printing & Stationery','Repairs & Maintenance','Salaries','Staff Welfare','Travelling Expenses','Vehicle Maintenance','Bank OD A/c','Secured Loans','Unsecured Loans','Reserves & Surplus','Duties & Taxes','Inter Co.','Provisions','Sundry Creditors','Sundry Creditors for Expenses','TDS Payable','Freight Charges','GST @ 18%Freight/courier','Local GST Sales','Sales Interstate','Advance to Suppliers','Sundry Debtors - Old','GST','Sales Tax 14-15','Sales Tax Payable','Advance From Customers',],
    "ledgers": ["3M Electro and Communication India Pvt. Ltd.-P""3M India Limited-P""3M India Limited-S""3S Infra Solutions""Aarav Unmanned Systems Pvt Ltd,""ABBI VALLEY RESORTS""ABHINAV SYSTECH PRIVATE LIMITED""ACCORD GLOBAL TECHNOLOGY SOLUTIONS PVT LTD""Accord Software and Systems Pvt.Ltd""Accounting & Compliance Fees""Accounting & Statutory Compliance""Accrete Pharmaceuticals Pvt. Ltd.""ACD COMMUNICATION PVT LTD""ACE Electrical Equipments Pvt ( LTD)""Ace Multi Ases Systems Ltd.""Active Power Systems""ACTON CABLES""Acton Electric Inc""ACU-FAB""Adarsha Controls Systems Pvt Ltd""Adarsh Imprest A/c""Adharsh Fabrics""Adhesive Solutions(Matl. Not Recd)""ADI Electronics Manufacturing Technologies Pvt Ltd""Aditya Birla Div. Yield""Aditya Birla Sun Life""Aditya Enterprises - P""Aditya Precitech Private Limited""AdSpark Systems,""Advaith Motors Pvt Ltd""ADVANCE CABLE TECHNOLOGIES(P)LTD""ADVANCED ELECTRONIC SYSTEMS""Advanced Materials& Processes Research Institute""Advanced Systems Laboratory""Advance Engineering Services""Advance Naval Systems Programme""Advance Received""Advance Salary - Mahadev""Advance Tax""ADVANCE TECHNOLOGIES""Advance to Lokesh""Advance to Mohan""Advance to Ramesh""Advertisement""Advertisement @5%""Aeprocurex Sourcing Private Limited""Aereo Manufacturing Private Limited""Agatya Enterprises""Agni Motors""Agriculture Expenses""AGRIM MRO SOLUTIONS""AIDDITION TECHNOLOGIES""AIDDITION TECHNOLOGIES PRIVATE LIMITED""Aidin Technologies Private Limited""AIMTECH""Air Conditioner""Air Freight Charges""Akademika Lab Solutions""Akarui Green Energy Solutions""A.K.ASSOCIATES""Akshara Enterprises""Akshatha B S""ALBA SALES CORPORATION""Alfa Electronics Services (I) Pvt.Ltd.""Alliance Mechatronics""Alltronix""ALPHA DESIGN TECHNOLOGIES PVT.LTD""ALPHA DESIGN TECHNOLOGIES PVT LTD Bng""ALPHA DESIGN TECHNOLOGIES PVT LTD(EOU)""Alpha Design Technologies Pvt. Ltd.- SEZ""ALPHA DESIGN TECHNOLOGIES PVT LTD - SEZ BNG""Alpha Elsec Defence &Aerospace Systems Pvt Ltd""ALTIGREEN PROPULSION LABS PRIVATE LIMITED""Aman Enterprise""Amara Raja Batteries Ltd""Amara Raja Power Systems Ltd""AMAR RADIO CORPORATION""Ambience Refrigeration Pvt Ltd""Ametek Instruments India Pvt LTd""AMEX Card (92004)""Amogh Enterprises""AMOOLYA RUBBER INDUSTRIES""Amphenol Interconnect India Pvt Ltd""Amphenol Interconnect India Pvt Ltd ( TM Division )""Ampolt Electronics India Pvt Ltd""Amrutheshwra Enterprises""Amu Software""Analog Devices India Pvt Ltd""Analogic Tech India Limited""Anantcars Auto Pvt Ltd""ANANTH TECHNOLOGIES LTD.""ANANTH TECHNOLOGIES PVT LTD""A.N & Co.,""Ankit Components""Ankitha Sharma""ANM GLOBAL PLYWOODS""Anvin Electronics Pvt Ltd""Aparna Constructions and Estates Pvt Ltd""Apollo Computing Laboratories (P) Ltd.""Apollo Micro Systems Limited""Applied Materials India Pvt. Ltd.""APW President Systems Limited""Aqtronics Technologies Pvt Ltd""Aradhana Agencies""A.R Car Point""ARCE POLYMERS PVT LTD""Archana DK""Areca Embedded Systems Pvt Ltd""AR Infomatrix Private Limited""Arka Aerospace Enterprises""Arora Enterprises""Artikel Inox""Artim Electronics Pvt Ltd""ARTY ENTERPRISES""ARUN STORES""Ascentech Engineering Solutions Pvt Ltd""Ascetic Multiserve Pvt.Ltd.""Asha Nagaraj Adiga""Ashwa Motors""Aspick Green Tech Pvt. Ltd.""Assembled Desktop""Astra Microwave Products Ltd""ATCO ENGINEER""Ather Energy Pvt Ltd""Atima Corporation Pvt. Ltd.""Atlant Global India (INC)""Atlas Distributors Pvt Ltd""A to Z Engineering & Maintennce Services""Atsuya Technologies Pvt Ltd""Audit Certificate Charges""Audit Fee""Audit Fees Payable""AutoMac""AUTOMOTOWARE PVT. LTD.""Avalon Technologies Pvt. Ltd. Unit II""Avasarala Technologies Limited""AVIAT Composites & Engineering Pvt Ltd""AVINASH CARGO PRIVATE LIMITED""Avinash Cargo Pvt Ltd""Avinash Techno Solutions Pvt Ltd""AVIRATA DEFENCE SYSTEMS LIMITED""AVIRATA DEFENCE SYSTEMS LIMITED (PUNE)""Axiom Research Labs Pvt Ltd""Axis Bank--36803144""Ayudha Pooja Expenses""Ayush Enterprises""Baddebts""Bahwan Cyber Tek Pvt. Ltd.""Bajaj Auto Ltd""Bajaj Life Insurance""BalajI Enterprises""Balance Written Off""Banderlog Pvt Ltd""Bangalore Kitchen Equipments""Bank Account GST""Bank Account IGST""Bank Charges IGST""Bank Charges & Interest""Bank Guarantee""Bank Gurantee - Accurex Solutions""Basic & DA""Battery A/c""Battery & UPS""BBMP Tax""BCS TECHNOLOGIES""Beacon Enterprises""Bel Optronics Devices Ltd""BEL Thales Systems""Benz Car Loan Account IDFC Bank(Recon)""Benz Car New""Benz Car Old""BESCOM Deposit""BEST & YOUNG ENGINEERS PVT LTD""Bhabha Atomic Research Centre""Bharat Dynamics Limited""Bharat Electronic Limited - Mumbai""Bharat Electronics Limited""BHARAT ELECTRONICS LIMITED - CHENNAI""Bharat Electronics Limited - Kotdwara""Bharat Electronics Limited-Panchkula""Bharat Electronics LTD""BHARAT ELECTRONICS LTD HYDERABAD""Bharat Electronics Ltd.(Machalipatnam)""Bharat Fritz Werner Ltd""Bharat Heavy Electricals Limited""Bharat Heavy Electricals Limited-Hyd""Bharat Surgical Co.""Bhargav""Bhatia Tools and Technology""Bhavyabhanu Electronics Private Limited""Bhavya Electricals""Bimal Auto Agency""BLACKFROG TECHNOLOGIES PRIVATE LIMITED""Blaze Automation Services Pvt. Ltd.""BLN-Bosch Automotive Electronics India""B. Lokanadha Naidu & B.Renuka""Blue Chip Electronics""BlueDart""Blue Fence Systems Pvt Ltd.-P-Hyd""Blue Hat Solutions Private Limited""Bohra Classic Tiles""Bonus""Bonus Payable""Boost Electronics-Unit-II""Bosch Global Software Technologies Pvt. Ltd.""Bosch Global Software Tech.Pvt Ltd""BOSCH LIMITED""Brady Company India Pvt. Ltd-P""Brady Company Private Limited""BRIGHT SUPPLY SYNDICATE""BSE Ltd.""B Sidde Gowda""BS Technotronics Private Limited-Hyd""BTL India Private Ltd""Building Insurence""Bulk MRO Industrial Supply Pvt. Ltd.""Busilink Associates""Business Promotion""Bycicle""Bynekaadu Trip Advance""Cable Charge""C A Electronics""Canara Bank(Syndicate Bank Sb A/c No.04782010031871""Capital Account""Caravan Oil Suppliers-P""Car - I20 - Hyundai""Car - Xylo""Cash""Cash Back""Cataler India Auto Parts Private Ltd""C C Camera""CEEG(NANJING) RENEWABLE ENERGRY CO., LTD.""CEEG(Nanjing) Renewable Energy Co., Ltd""CEEG(Shanghai) Solar Science Technology Co., Ltd""Celliber Technologies Pvt. Ltd.""Center for Devlopment of Advanced Technology""Centre for Development of Advanced Computing""Centre for Development of Telematics""Centre for Materials for Electronics Technology (C-MET)""Centre for Materials for Electronics Technology [C-MET]""Centum Electronics Limited""CGST 14%""CGST @ 1.5%""CGST @ 2.5%""CGST @ 6%""CGST @ 9%""China Sunergy (Nanjing) Co., Ltd.""China Sunergy Trading(HongKong) Co.,Ltd""Chinmaya Micro Technologies""Chrome Motors""Classic Packings""Clearing Charges""Clivesysnet INC""Clivesysnet Pvt Ltd""ClodPi Labs (India) Private Limited""Closing Stock""Club Membership Fees""Cochin Shipyard Ltd""Comfort Seating System""Commission Paid""Comprotech Engineering Pvt.Ltd""COMPUPOWER PRIVATE LTD""Computer""Computer Maintenance""Comtek Services""CONFEDERATION OF INDIAN MSME IN ESDM AND IT (CIMEI)""Confident Electronics Pvt Ltd""Consolidated Pvt. Ltd.""Consolidated Teknics India Pvt Ltd""CONSORTIUM OF ELECTRONIC INDUSTRIES OF KARNATAKA""CONSULTATION FEE""Consumables -Purchases""Continental Hotel""Convergent Communication (India) Pvt.Ltd.""Conveyance Allowance""Conwo Solutions""CoreEL Technologies (I) Pvt.Ltd.""Corporation Bank - 510101003222402 RR Nagar""Corporation Bank Loan (2938)""Corporation Bank OD031174""Courier Charges""Courier Charges GST""COVID 19 UBl Loan A/c No.4572(Recon)""Creative Technologies Inc""Credit Card-Deshikan""Credit Ccard -Omniscient""Criador Design Labs Pvt. Ltd""Crocus Technologies Pvt Ltd""Crome TV""Crossways Vertical Solutions Pvt. Ltd.-P""CRSST""C Square Supply Chain Solutions""Cst14% Tax""Cst 14.5% Tax""CST 2% Tax""CST 5.5 % Tax""CST Diff Tax Collected""Cubitronics Integrated Solution Pvt Ltd""Customer Entertainment""Customs Duty""CUSTOM WRAPS INDIA""Cutting Charges 12%""Cutting Charges 18%""Cutting Charges 28%""Cybermotion Technologies Pvt Ltd""Cygni Energy Private Limited""Cyient DLM Pvt Ltd""Cyient Limited""Damerages""Data Patterns ( India Limited )""DATA PATTERNS (INDIA) LIMITED CHENNAI""D-Cube Print House""DCX SYSTEMS LIMITED""Decibels Electronics Pvt Ltd""Deepa Screen""Defair Integrations Pvt. Ltd.""DELHIVERY LIMITED""Delivery Limited""Dellner India PVT.Ltd""DENSO KIRLOSKAR INDUSTRIES PVT.LTD.""Depreciation""D-ESPAT PVT LTD""Destop LED Lenovo 18.5 Monitor""Devi International""DhaSh PV Technologies Pvt. Ltd.""DHL Express (India) Pvt. Ltd.""Dhoot Industries""Dhoot Transmission Pvt Ltd""DHRUVA CONSULTANCY SERVICES""Dhruva Space Pvt Ltd""Die Charges""Die Charges @ 18%""Digikey Electronics""Director, DRDL""Director of Extension""Director Remuneration Recd.""Divakar's Global Hospitals""Dividend""DOLLAR INDUSTRIES LTD""Dolphin Irrigation""Donations""Drawings""Dsc Registration Charges""DSP India Tiger""Duties & Taxes Refundable""Duty Payment Collected""Dynamatic Technologies Limited""E2O Car Advance""EAC MARINE PRIVATE LTD""Eastern Petro Technologies (India) Pvt.Ltd.""Easun-MR Tape Changers( P) Ltd""ECO Friends""Eco-Luminate Technologies Pvt Ltd""E Control Devices""ECONTROL DEVICES PRIVATE LIMITED""ECORADIX COLDCHAIN PVT LTD""EDAC MULTITECH PVT LTD""Education Cess""EFFTRONICS SYSTEMS PVT. LTD. ""EFY Enterprises PVT LTD""EGSTON ELECTRONICS (INDIA) PRIVATE LIMITED""Elcom Innovations Pvt. Ltd.""Electricity and Water Charges""Electricity & Water Charges Payable""Electro Circuit Systesms""Electrohms Private Limited""Electro Magnetic Devises""Electronic Control and Discharge System Pvt Ltd""Electronics and Radar Development Establishment""Electronics Corporation Of India Limited""ELECTRO OPTICAL INSTRUMENTS RESEARCH ACADEMY""Electrotherm Immode Renewables Ltd""Elegance Vision Private Limited""Elematic Trading India Private Limited""Element 14""Elenserve Technologies""ELITE LABELS PVT LTD""Elixir Engineering""Elliott Ebara Turbomachinery India Pvt. Ltd.""ELMAS MAGNETICS PVT.LTD.""Elmas Magnetics Pvt.Ltd. UNIT-1 (100%EOU)""Elura Design ( Netharavathi)""Emahendra""Embedded IT Solutions (India) Pvt.Ltd""Em Electronix Private Limited""Emmar Magnet Wires""Emmar Magnet Wires-P""Emprise Marketing-P""E Mudra Ltd.""Energymax Power Systems Private Limited""Enfinity Solar Solutions Private Limited""Eolane Electronics Bangalore Pvt Ltd""Epoxy Technologies Pvt Ltd""EQIC DIES & MOULDS ENGINEERS PVT LTD""Equinox Solar Pvt. Ltd""Ertiga Car""ETA Technology Pvt Ltd""E-Tech Resources PTE Ltd""Eureka Forbes Ltd.""Eureka Value""Eureka Water Purifier""Exa Thermometrics India Pvt.Ltd.""Exchange Diff.""Exchibition Expenses""Exempted Sales""Exhibition Expenses""Exicom Energy Systems Private Limited""Exicom Tele System Limited""Exide Life Insurance""Export Commission Received""E Zone""Fabricons""FACTOR ENOVATIONS PRIVATE LIMITED""Faiveley Transport Rail Technologies India Limited""Father Jerom""FCI OEN Connctors Ltd.""FCI OEN CONNECTORS""FCI OEN Connectors Ltd-Blr""FD 01/170403""FD 39361 As Per FD Rect(Lien to Tata)""FD 39361 Lien to Tata(Against Loan)""FD 49560 As Per FD Rect(Lien to 3M)""FD 57302 As Per FD Rect.""FD 58540 KCC As Per FD Rect(Lien to Bank)""FD 98919""FD for BARC BG""FD/KCC/01/100428456""FD/KCC/01/170377""FD KCC 01/70597""FD Union Bank of India A/c 98553""Featherlite Office Systems ( Pvt) Ltd""Federation of Karnataka""FedEx Express TSCS (India) Pvt Ltd""Filmore Led Pvt Ltd""Firefly Led Products Pvt Ltd""FKCCI""FlamencoTech(India) Pvt Ltd""Flat Loan 35069 UBI""Flipchip Electronics Pvt Ltd""Flor Tech""Focus Industrial Solutions-P""Fokker Elmo SASMOS Interconnection Systems Ltd""Fokker Elmo SASMOS Interconnection Systems Ltd - SEZ""Forbiz International""Forevision Instruments (India) Pvt.Ltd.""FortuneArrt LED Lighting Pvt Ltd.""Forwarding IGST @ 18%""Four Square Media (P) Ltd""Fowler Westrup (India) Pvt Ltd""Freight Amount""Freight Charges @ 5%""Freight Charges Gst 18%""Freight charges GST @ 18%""Freight Charges GST @18%'""Freight Charges IGST @ 18%""Freight Charges Inward""Freight Charges SEZ""Freight Inward 18% SEZ""Freight Inward Gst @12%""Freight Inward Gst @ 18%""Freight Outwards""Freight Returns""FrontLine Electronics Ltd,""Furniture & Fixtures""Futura Automation Pvt Ltd""FUTURA DIGITAL""Fuzen Inc.""Galaxy Enterprises""Gallium Arsenide Enabling Technologies Centre""Ganesh Electronics and Electricals""Ganganna""GARWARE POLYESTER LIMITED""Gaurav Enterprises""Gautamesh Industries""Gautam Graphics & Stationery""G B Enterprises""GE India Technology Centre Private Limited""George""Geyser""GG Tronics""GH TECHNO WORLD""Gift Item""Gift Recd.""Glastronix LLP""Global Electronics""Global Travel Services""GM Enterprises""GOODRICH AEROSPACE SERVICES PVT LTD""Good Wheel Teravells""GOOD WILL SALES CORPORATION""Gopi Hardware & Generals""GO TOUR TRAVELS AND HOLIDAYS""GOUTAM GRAPHICS & STATIONARY""Govt. E-Marketplace(GEM)""Gowra Aerospace Technologies Pvt. Ltd.""Gowtham Graphics""Green Eco Ventilator""Grinntech Motors & Services PVT Ltd""GRUPO ANTOLIN INDIA PRIVATE LIMITED""GST 18% Sales""GST @ 18%Discount Allowed""GST @ 18%Discount Allowed - Sales""GST @ 18% Discount Recd.""GST @ 18%Packing & Forwarding""GST@18% Server & Maintenance Charges SIHMA Software""GST Interstate Sales @12%""GST Payable""GST Pur @28%""GST Purchase @12%""GST Purchase @ 18%""GST Purchase @5%""GST Purchase Local @ 28%""GST Sales 5%""GST Sales @ 18%""GST SALES @28%""GST Sales @5%""GST Sales Interstate @ 18%""GST Sales SEZ""GTDS Recievble""G V Modules""HaAVIT Retail""Halvoet Rubber & Plastic Tech India Pvt Ltd(EOU)""Hand Loan""Hansraj Systems and Traders""Hardware""HARI OM ENTERPRISES""HARSHA""HARSHA ENT""HARSHA ENTERPIRSE""HBL POWER SYSTEMS LTD""HBL Power Systems Ltd - Hyd""HBL Shameerpet (M)""HCL SERVICES LIMITED""HDFC Commercial Card 8706""HDFC Credit Card-2298""HDFC Life Insurance""HDFC Life Insurance Matured""HDFC MF""HDFC SB A/c 64347 R""Heatcon Sensors (P) Ltd.""Helvot Rubber and Plastic Technologies""Hemanth (Car)""HERBOPHARM INDIA ENTERPRISES""Herman Miller India""Hical Technologies Pvt. Ltd.""Hictronics Devices Pvt Ltd""Higher Secondry Education Cess""Himil Uwave ResearchCo Pvt Ltd""HINDUSTAN AERONAUTICS LIMITED""Hindustan Aeronautics Limited - Korwa""Hindustan Aeronautics Limited (Lucknow)""Hindustan Aeronautics Ltd - HYD""HINDUSTAN HARDWARE AND SANITARY""Hindustan Magnesium Products Pvt Ltd""Hindustan Security Services""Hi-Q ELECTRONICS PVT.LTD""HLBS TECH (P) LIMITED""Hobby Tools & Components""Homeopathy Tablets""Honey Well Automation India Ltd""HONEYWORKS LLP""HORIZON AEROSPACE(INDIA) PRIVATE LIMITED""Hosur Plant-TVS Motor Company Limited""HOTEL ASRANI PRIVATE LIMITED""Hotel Swati""HOTEL THE FORTUNE""Housing Loan 392635""H P ENTERPRISES""HPS LAB DESIGN PVT LTD""HRA""Hublin Enterprises""Hubner Interface Systems (India) Private Limited""Huf India Private Limited""Humanetics Innovative Solutions India Private LTD""Humanity works""HUMAN SPACE FLIGHT CENTRE""Hyderabad Eye Research Foundation""Hyderabad Office Imprest.""Hyundai I20""I2R Design Bangalore""Icegate""ICICI Credit Card - 81004""ICICI Credit Card - 81008""ICICI Current A/c No.166405000485 (R)""ICICI Loan A/c No.7721199589-Flat""ICICI Mutual Fund""ICICI Prudential""ICICI SB""ICP (India) Pvt. Ltd.""IDBI 1013 Loan A/c""IDENTIS TECH SOLUTIONS PVT. LTD.""IDFC Bank Ltd.""I Forex India Pvt. Ltd.""IFSC Bond""IGST 5%""IGST @12%""IGST @18%""IGST @ 18% Freight Charge""IGST @ 28%""IGST Commission @18%""IGST Freight Charges""IGST Purchase 28%""IGST Purchase @ 12%""IGST Purchase @18%""IGST Purchase @ 5%""IGST Sales @ 18%""IGST Sales @ 28%""IGST Sales @5%""IGST SEZ Sales @ 18%""IIT Madras""IKA India Private Limited""I LABELS""IMAGE LABELS PVT.LTD.""Imagineering""Impex Insulation Pvt Ltd""Import Purchase""Imprest A/c""INCAP CMS PVT LTD DTA""INCAP Contract Manufacturing Services Pvt. Ltd.""Incentive""Income Tax""Indeed India Operations Pvt. Ltd.""Indiamart Intermesh Limited""Indian Cables & Electricals Pvt Ltd""Indian Institute of Astrophysics""Indian Institute of Science.""Indian Institute of Space Science and Technology""Indian Institute of Technology GOA""INDIAN INSTITUTE OF TECHNOLOGY HYDERABAD""Indian Institute of Technology Madras""INDIAN PRECISION ENGINEERS""Indica Industries Pvt. Ltd.""Indic EMS Electronics Pvt Ltd""Indus Teqsite Private Limited""INDUSTRIAL ELECTRICALS""IndustryLane Solutions Pvt Ltd""INFINITI RETAIL LIMITED (Croma)""INFIPLUS TECHNOLOGIES PVT LTD""Infi World""Innovative Medical System""Innov Lite (India) Pvt.Ltd""Instel Engineer""Institute of Kidney Diseases & Research Centre""Insulation Inventor (India)""Insurance""Insurance Maturity""Integral Labels (P) Ltd.""Integra Micro Systems Pvt Ltd""Intel Technology India Private Ltd""Interest Accrued""Interest on BG""Interest on Car Loan""Interest on Housing Loan - Flat""Interest on Housing Loan Konanakunte""Interest on Housing Loan - No.3260""Interest on Other Loan""Interest/penalty""Interest Recd. on RD""Interest Recd. on SB A/c""Interest Recd. Others""Interest Received - FD""Interglobal Aviation Ltd.""Interglobal Aviation Ltd. - B'lore""Internet & Website Charges""Internet & Wesite Charges IGST""Interstate Purchase""Inventaa Mouldings""Invento Labs Pvt Ltd""Inventriq Solutions""I-O Sign International Pvt. Ltd.""IPA PVT LTD.""ISO Certification""ISRO Satellite Centre""ISRO TELEMETRY TRACKING AND COMMAND NETWORK-ISTRAC""ISTRAC""ITW Specialty Materials (Suzhou) Co.,LTD""IUCAA""I Wave Systems Technologies Private Limited""Jain Switchgear Products""Janata Abrasives""JB Instruments Pvt. Ltd.""Jewellery""JJC ENGINEERING PVT LTD""JJ GLASTRONICS PVT LTD ( UNIT-II)""JVS Enterprises""JYRIS DEVICES ""KALKI COMMUNICATIONS TECHNOLOGIES PVT LTD""Kalyani Motors Pvt. Ltd.""Kalyani Rafael Advanced Systems Pvt Ltd""KANTHARAJU""Kanti Enterprises""Karnataka Hybrid Micro Devices Limited""Karthik Enterprises""KAUSHAL ENTERPRISES""Kaynes Technology India Limited""Kayvee Sales Corporation""KELTRON CONTROLS""Kerala State Electronics Development Corporation""KERALA STATE ELECTRONICS DEVELOPMENT CORPORATION LTD""KEWAUNEE LABWAY INDIA PVT LTD""Key Motor Ventures Pvt Ltd""KIOT COMMUNICATIONS LLP""Kiot Innovations Private Limited""KLAD ON DESIGN PVT LTD""KMS & Co.""K N Pushpa Lease Amount""Kone Elevator India Pvt Ltd""Kopran Laboratories Limited""Kotak Loan A/c No.Dl00000060""Kotak Loan A/c No.Dl00000061""Kotak Loan A/c No DL0100000064""Kotak Mahendra Insurance""Kotak Mahindra Bank-CC (R)""Kotak Mahindra Bank-OD (R)""KPTCL, Executive Engineer""Krishna Engineering""Kukreja Electronics""KUSALAVA INTERNATIONAL LTD""KVR SHOPPEE""Laboratory For Electro-Optics Systems (LEOS)""Labour Charges Paid""Lakshman Rao GST Auditor""Lalith""Lanasol Energy Solutions Private Limited ""Laptop""LARSEN AND TOUBRO LIMITED""Laser Sharp""Late Deduction""Late Delivery Charges""Lease Amount K N Pushpa""Leave Deduction""Le Coffee Resort""LEG WORK""LEOS-ISRO""LIC Premium""LIC SB""Liquid Propulsion Systems Centre""Load Master""Loan A/c on FD 57302""Loan - Deshikan""Loan on FD 300051""Loan on FD 300052""Loan on FD 428026""Loan on FD-58540 KCC""Loan on FD 58540 KCC A/c No.4184""Loan - Seshadri""Local Conveyance""Local Purchase 14.5%""Local Purchase 5%""Local Purchase 5.5%""Local Purchases 14%""Long Term Capital Gain""Lords Engineering""Lotus Antennas And Microwave Technologies Pvt.Ltd""Lotus Tapes (India) Pvt Ltd""Lotus Tapes (India) Pvt Ltd ""L.P Borewells""LPS Bossard Pvt Ltd""L & T Construction Equipment Ltd""L & T Technology Services Limited""Lucas-TVS Limited""Madhukar Domestic Appliance (P) Ltd""MAG India Industrial Automation Systems Pvt LTd""Mahathi Technologies""MAHAVEER PLY AND HARDWARE ""MAHESHWARI INC""Mahila Mandali Vidya Samsthe""Mahindra & Mahindra Ltd""Mahindra TUV300""Mak Controls and Systems Pvt. Ltd.""Make My Trip""Mak Plywood Industries Pvt .Ltd""Mandovi Motors Pvt Ltd""Manik Enterprises""Manva Enterprises""Manya Enterprise""MANYA ENTERPRISES""MARGEN IMPLEX LIMITED""Maria Enterprise""Maria Enterprises - P""Mark1 Aerospace""MARS Technologies Inc. P""MARUTHI INDUSTRIES""Marvel CNC Technologies""Marvel Corporate Solutions""Masatya Technologies Private Limited""Masstrans Technologiies Private Limited""Mathaji Electricals""Mathrusri Management Services""Maya Plastic &Co.""Medha Rail Pvt. Ltd""Medha Servo Drives Pvt Ltd-Hyd""Medical Expenses""Medical Insurance Claim""Mediclaim Insurance""Medi Systems""Megha Travels""Menino Interiors""Merlinhawk Aerospace Private Limited""Messe Muenchen India Private Limited""MESSE MUENCHEN INDIA PRIVATE LIMITED, Gujarat""Metro Tech Builders""MicroLOGIX""MicroLOGIX Embedded Controls(P) Ltd""Micropack Private Limited""Microwave Tube Research and Development Centre""Miles of Smiles""MIND COMPPROPERTIES PVT LTD""Miracle Electronic Devices Pvt. Ltd""Miscelleneous Expenses""Misc Receipts""MISTRAL SOFTWAREPVT LTD""Mjunction Services Limited (BS01)""MM Equipments""MM POLYMERS""M N Hussen & Co,""Mobile Hand Set""Momentive Performance Materials (India) PVT LTD""Monarch Enterprises""Mondavi Motors Pvt. Ltd""Montonix Monitoring Solutions""Moog Controls (India) Pvt Ltd""Moog Motion Controls P Ltd""MORPH DESIGN COMPANY""Motilala Oswal Demat A/c""Mouser Electronics""M R Enterprises""MROTEK""MRSP Enterprises""Mrudani Power Controls""Mr.Venugopal - Auditor""M/s. Boson Motors Pvt Ltd""M/s. Gill Instruments PVT Ltd""MSME Corp Loan A/c No.676409""M/s. Mufaddal Tools & Hardware""M S Pearl Plastic""MS Ramaiah Memorial Hospital""MTAR Technologies Pvt.Ltd""Multilinks""Muppiri Developers""MVS Technologies""Nalini Marketing Pvt LTD""Nandini Green Energy Pvt Ltd""Narayani Enterprises""Nash Industries (I) Pvt.Ltd""National Aerospace Laboratories""National Center for Biological Sciences""NATTESH & ETTA""Naval Armament Depot (NAD)""NAVEEN AUTO ELECTRICAL WORKS""Neelkanth Car Decor""Neo Labels Inc.""Nesara Tours LLP""Nethra Crop Sciences Pvt. Ltd.""Nettigritty Private Limited""New Battery Centre""New SK Light House""Newsline Printers Bangalore""News Paper & Periodicals""Newtech Solutions""Next Level Touch Solutions Pvt Ltd""N.G.Marketing""NGP Solutions""Nikhil Engineering Company-P""Nimbeswar Packaging""Nimble Wireless Private Limited""Nirmal Hardware & Electricals""N.K.RFPRODUCTS & SERVICES PRIVATE LTD""N.M ARUNKUMAR & P.S ANANDA RAO & CO""Nonferrous Materials Technology Development Centre""Nova Integrated Systems Limited""NS CORPORATION""NSDL E - Governance""NSK Electronics""Nucon Aerospace Pvt Ltd""NUTEK TECHNOLOGIES PVT LTD""nVent Electrical Products India Pvt Ltd""OCEAN ROBOTIX""Ofcons Projects & Services Pvt. Ltd.""Office Maintenance""Office Maintenance @ 28%""Omniscient Electronics Pvt. Ltd""Omniscient Electronics Pvt. Ltd.- Dr.""Omniscient Electronics Pvt. Ltd. Tr. Advance""Omniscient Technologies""Om Trading Company""ON Semiconductor Technology India Private Limited""OORJA ENERGY ENGINEERING SERVICES""Opening Stock""Oriental Tools Company-P""Other Allowance""Other Allowances""Outstanding Expenses""OXFORD ENTERPRISES""Oxygen Cylinder""Packing Charges""Packing Charges IGST""Packing Charges Intertate""PACKS SALES CORPORATION""Pai International Electronics Ltd.""Palakkad Surgical Industries Pvt. Ltd.""Panchamukhi Art Process""Paravathilabels""Parimala Sweets""Parker Electronic Pvt Ltd""Parker Hannifen India Pvt. Ltd.""Parth Electricals and Engg P Ltd""Pasolite Electricals Pvt Ltd,""P Buchi Babu & Janardhan Naidu""PEEKAY STEEL CASTINGS (P) LTD.""Peenya Industries Association""Petrona Industries""Petty Cash""Pfeiffer Vacuum ( India) Pvt Ltd""Philips Electronics India Ltd""PIONEER ADHESIVES""PIXXELSPACE INDIA PRIVATE LIMITED""Plant and Machinery""Plus Thermo Induction""Polypackers""Ponnar Precision Engineering-P""Pooja Associates""Pooja Expenses""Pooja Paper and Stationery""POORNA TECHNOLOGIES""Poorvi Printers""Portescap India Pvt.Ltd (Stepper Motors)""Postage and Telegram/courier""Power Control Systems""POWERHUB ETCH SOLUTIONS""Powermech Controls & Safety""Power One Pte Ltd""Power Point""Powertech""Power Tools and Tackles""PRAGATHI STATIONERY MART""Prasad Imprest""Pravaig Dynamics Pvt. Ltd.""Precision Electronic Components Mfg. Co.""Precision Engineering Embracing Innovation""Preethi Printers""Premier Evolvics Pvt Ltd""Prepaid Insurance""Prerana Motors (P) Ltd""President""PRESTINE HARVEST""Preston Image Tech Pvt Ltd""PRICE DIFFERENCE""Prime Marketing""PRIME MARKETING (GOA)""Prince Charles""Printing and Stationery Purchsae @18%""Printing & Stationery @ 12%""PROACT IMS PRIVATE LIMITED""PROACTIVE POLYMERS""Professional Charges""Professional Charges Payable""Professional Tax Payable""Profession Tax Renewal""Profit & Loss A/c""Profit on Sale of Car""PROMPT SERVICES""Prompt Solutions Pvt Ltd""Prop. at Konanakunte - Hyp to UBIN-OD""Property No.1013 Girinagar""Prop No.3260 Office - Hyp UBIN""Prop No.3260 Residential - Hyp UBIN""Protean Egov Technologies Ltd.""Provision for Income Tax""Pruthvi""PS Corporation""PT""Purchase Advance""Purchase Exempt""Purchase Exempted""Purchase Import""Purchase of security""PURCHASE RETURN""Pursuit Technologies Pvt Ltd""QUALTECH TELESYS PVT LTD""Quantum Energy Limited""QUANTUM ENERGY LIMITED (HYD)""Rajamane Industries Pvt Ltd""RAJAMANE TELECTRIC PVT LTD""Rajani Tempo Service""Raj Glass Industries""Raj Outsourcing""Ramdev Hardware""Ramesh""RAMVEE ASSOCIATES""RANEAL ADVANCED SYSTEMS PVT. LTD.""Rangsons Aerospace Pvt. Ltd.""Rangsons Deefence Solutions Pvt Ltd""Rangsons Electronics Pvt Ltd""Rapid Info Solution""Rapsri Engineering Products Limited""Rate Diff. @ IGST 18%""Rate Difference""Rates & Taxes""Ravindranath GE Associates Pvt Ltd""Ray Energy Solutions""RD 530701198698919""RD A/c No : 007423040000308""RD A/c No : 007423040000500""RD A/c No 007423040000112""RD A/c No 007423040000113""RD A/c No 007423040000307""Rd A/c No.530701198986063""Rd A/c No.530701198986090""R&D Expenses""Reccuring Deposit / KCC/01/150748""Reckon Green Innovations Private Limited""Recruitment Charges""Recurring Deposit - 530701196736215""Reddy Borwell""Refrigerator""Regal Enterprises""Registration & Membership""RELIANCE INDUSTRIES LIMITED""Reliance Jio Infocomm Ltd.""Remidio Affordable Innovations""Renesas Electronics India Pvt Ltd""Rent""Rent Advance OEPL""Rent Deposit - Konanakunte Prop. Ground Floor""Rent Deposit - Konankunte Prop. 1st Floor""Rent Deposit - Omniscient Technologies""Rent Payable""Rent Receivable""Rent Received""Renxsol Ecotech Pvt Ltd""Repaire & Maintance - Building""Repairs and Maintenance - Others""Repairs & Maintenance @ 5%""Repairs & Maintenance - Building IGST""Reproplus""Research Centre Imarat""Reserve for Bad & Doubtful Debts""RETURNS MATERIALS""Ripple Technologies""RITHVIK ENTERPRISES""R K Enterprises""RKGP & Associates""R.K.Hardware & Paints""R Logic Technology Services India Pvt Ltd""R Nagraj""RNR ECOTECH SOLUTIONS""Roop Telsonic Ultrasonix Ltd""ROSHAN ENERGY TECHNOLOGIES PVT LTD""Rossell Techsys""Rossell Techsys Limited""Round Off""Round Off IGST""Royal Hardware Mart""Royloak Incorporation Pvt Ltd""RR Flat Advance""Rs1215s/h2""RS Components & Controls (India) Ltd""RYAN TECHNOLOGY""Saab India Technologies PVT Ltd""Saankhya Labs Pvt Ltd""Sachin""SAHARA LABELS PRIVATE LIMITED""SAHNEY COMMUTATORS PRIVATE LIMITED ""Sailesh Chandrasekar""Sai Marketing""Sai Praman Technologies""Sai Sri Labels India Pvt Ltd""Salarpuria Flat - Residence""Salarpuria Properties Pvt. Ltd.""Salary""Salary Advance""Salary Advance Gopinath""Salary Advance - Kiran""Salary Advance-Kiran Gowda""Salary Advance - Kumar""Salary Advance - Mohan Kumar""Salary Advance Prabhu""Salary Advance-Santhosh""Salary Advance Srimali""Salary Payable""Sales and Mktg. Auxillary Svcs""Sales Tax Payable""Samrudhi Innovative Solutions""Samsung LED (T V)""Samyuktha Karnataka""Sandisk IN Devise Design Centre Pvt Ltd""San Engineering & Locomotive Co.Ltd""Sanitary Napkins""Sanjay Tools & Accessories Pvt Ltd""Sannidhi Hospital""Sanseera Engineering Ltd.""Santhosh Glass & Plywood""Saphire Motors Pvt Ltd ( Blue Hyundai)""Saptagiri Enterprises""Sarvam Safety Equipment (P) Ltd.""Sasmos HET Technologies Limited""SasMos HET Technologies Ltd""SasMos HET Technologies Ltd (SEZ)""Sasmos Het Technologies Pvt Ltd""Sathish""SATISH DHAWAN SPACE CENTRE SHAR""Satnam Metal Solution""Satys Electric (India) Pvt Ltd.""SBI Mutual Fund""SBI SB A/c No.54003832821 R""SBL Technologies""Schiller Healthcare India Pvt. Ltd.""SCHNEIDER PROTOTYPING INDIA PVT. LTD.""Schnell Energy Equipments (P) Ltd""Security Deposit with 3M India""SeeBee Technologies""Sellex Incorp""SEMI CONDUCTOR LABORATORY""Sensel Telematics Pvt Ltd""Sensomatic""Serana Distribution & Services""Serenity Blue Group""Service Charges""Service Charges for the Year 2021-2022""Service Charges - Sales""Service Tax""Service Tax 12.36%""Servotech Power Systems Pvt Ltd""SEZ Sales Exempt""SEZ Sales Taxable""SFO Technologies Pvt Ltd""SFO Technologies Pvt Ltd -Cochin""SFO Technologies Pvt Ltd - Ernakulam""SGST 14%""SGST@1.5%""SGST @ 2.5%""SGST @ 6%""SGST @ 9%""SGS TEKNIKS MANUFACTURING PVT. LTD.""Shakthi Industrial Corporation""SHAKTI HORMANN PRIVATE LIMITED""Shambhavi Enterprises""Shamith Traders""SHANTHINATH ELECTRONIC PARTS (I) PVT LTD""SHANTINATH ELECTRONIC PARTS""Sharath Jay""Shares with Omniscient Electronics Pvt. Ltd.""Sheen Electroplaters Pvt Ltd.""Shiva Engineering Works""Short Term Capital Loss""Shree Electricals-P""Shreeji Corporation""Shree Krishna Associated""Shreelakshmi Enterprises""Shree Mahendra Associates""SHREE MARUTHI COURIER SERVICES""Shree NM Electricals Limited""Shree NM Electricals Ltd""ShreeRaksha Courier & Cargo""SHREE SHOBHA ELECTRICALS""Shree Vidya Enterprises""Shri Prakash Electricals and Light House""Sidhi Vinayaka Fab Eng""Sieger Robotek Electric Private Limited""Siemens Limited""SIKA INTERPLANT SYSTEMS LIMITED""Silicon Institute of Technology""Silver Track Systems & Services Private Limited""Sipani Energy Limted""Sipra Surgi Med Pvt Ltd.-P""Sireesh Auto Pvt Ltd""Site Advance 1013""SKanda Technologies""Skill Tech""Sky N Land Video Networks Pvt Ltd""SLN Fire Service""SLNS Technologies""SLV Graphics""SLV Saw Mills & Wood Inds.""Smartlink Network Systems Limited""Smart Solutions""Smarttech Business Solution""SM ENTERPRISES""SM MANJULA""S M SYSTEMS""SNAB GRAPHIX (INDIA) PVT LTD""S N Enterprises""Software""Software Charges""Software Renewal""Solar TVS""Solus Security Systems Pvt Ltd""Sonodyne Electronics Pvt Ltd""Southern Electronics (Bangalore) Pvt. Ltd""Southern Packaging""South Western Railway""Space Design""SPACE DESIGN FURNITURE AND FIXTURES INDIA PVT LTD""Spectra Elevators""Spectra Fab Engineers""Spectrochem""SPG INFOTECH LIMITED""Sps Developers""Sree Balaji Tyres""Sree Devi Electricals & Enterprises""Sreemali Imprest A/c""Sreenivasan and Co""Sree Sreenivasa Jewellers""Sri Balaji Developers""Sri Balaji Glass & Plywoods""Sri Banashankari Tyres""Sri Krishna Hardware""Sri Mallikarjuna Buildrers & Developers""Sri Mangalama Hardware""Srinivasa Electricals""Sri Ranganatha Printers""Sri Sai Creations""SRI SAKTHI INNOVATIONS""Srisha Advance""Sri Siddhalingeshwara Electricals""SRITECH ELECTRONICS & SYSTEMS PVT. LTD.""Sri Vijaya Lakshmi Fabricators""S.R.S. TRAVELS / S.R.S. LOGISTICS""Sse Enterprises""S S Enterprises""S S Impex - P""SSM Technologies.,""S.Sobhagchand""S.S. TOOLS & COMPANY""Staff Welfare""Staff Welfare 5%""Staff Welfare Exempted""Starhealth Insurance""State Bank of India A/c No.38180576326""Static Sysytems Pvt Ltd""Stesalit Systems Limited""Sticwell technologies pvt ltd""Stock Insurance""Strava Collective LLp-""STS Titeflex India Pvt. Ltd.""Suguna Hospital""Suguna Pharmacy""Sulochana""Sulochana Enterprises""SUMITRON EXPORTS PVT.LTD""SUNDERDAS D.HUNSRAJ""Sun Mobility Private Limited""Sunrich Abrasives Co. Ltd.""Sunshine Print Solutions""SUNSTAR LABELS""Super Technologies Pvt Ltd""Suresh Kumar""Sure Step Solutions Pvt Ltd""Survival Benefit""Suspense A/c""S.V.Polypacks""SWASTIK ASSOCIATES""Syndicate Bank A/c No.000135363492""Synthesis Winding Technologies Pct. Ltd""Sysmex India Pvt Ltd""Systech IT Solutions Ltd (Les)""Systech It Solutions Pvt. Ltd(LES)""Sytech Engineering Pvt. Ltd""Sy-Tech Engineering Pvt Ltd Bng""Talema Electronics ( India ) Pvt Ltd""Tata Advanced Materials Limited""Tata Advanced Systems Limited""Tata Advance Material""Tata Capital Financial Services Ltd.""Tata Capital Ltd.""Tata Consultancy Services Ltd""TATA CONSULTANCY SERVICES LTD (GOA)""TATA ELECTRONICS PRIVATE LIMITED""Tata Hexa""Tata Insurance""Tata Power Company Limited Strategic Engineering Division""TCS of 3M""TCS Others""TDS""TDS 3M 194R""TDS by Bank""TDS From Customers""TDS Interest""TDS on 194I Rent""TDS on FD Interest""TDS Payable on 194Q""TDS Payable on Commission""TDS Payable on Contract""TDS Payable on Contract (194C)""TDS Payable on Interest (194A)""TDS Payable on Professional -194J""TDS Payable on Salary (192B)""TDS Personal""TDS Receivable From Tata Capital""Team Aviation India Pvt Ltd""Team Engineers Advance Technologies India (P) Ltd""Team Maintainance Specialities""Techno Instrument Company""Tejaswi Manufacturing Pvt LTd""Teknik Elevators Pvt Ltd""Teknix Elevators Pvt Ltd.""Telephone & Mobile Expenses""Telereach""TEMSRAX INDIA PVT LTD""Tender Applicattion Fees""TENTACLE AEROLOGISTIX PVT LTD""Terabeam Proxim Wireless Private Limited""Term Loan 8063TL0100000026 Kotak on 3260""Tessolve Semiconductor Pvt Ltd""T GLOBAL TECHNOLOGY""The Director""THE KARNATAK METAL INDUSTRY""The Programme Director, PGAD""Thermo Cables Ltd""Thermopads Pvt Ltd""The Special Officer NSP""Titan Company Limited""TMEIC INDUSTRIAL SYSTEMS INDIA PRIVATE LIMITED""TOD Kotak Mahindra Bank""Tonbo Imaging Private Limited""TOOL CRIB INDIA LLP""Toshiba Transmission & Distribution Systems Pvt Ltd""Toys & Sports""Track Innovations""Transportation Charges""Trasccon""Trasccon Interconnection Systems P Ltd""Trasccon Strategic Solutions Private Limited""Travel Advance - Dileep""Travel Advance-Dinesh Babu""Travel Advance - Giribabu""Travel Advance - Gopinath""Travel Advance - Hemanth""Travel Advance - Jeevan""Travel Advance - Lokesh PR""Travel-Advance-Mahadev Prasad""Travel Advance - Manikandan""Travel Advance - MOHAN SIR""Travel Advance - Pandurang""Travel Advance - Ramesh Bhanushali""Travel Advance - Ramesh S""Travel Advance - Shankar""Travel Advance - Sreemali""Travel Advance - Srisha""Travel Advance - Trivedi""Travel Advance - T V Deshikan""Travel Expenses @ 18%""Travel Expenses IGST 5%""Travel Expenses IGST @ 12%""Travell Advance - Shreyas""Travell Exps. - Local @ 5%""Travelling Advance - JOE""Travelling Advance - Krishnamurthy""Travelling Expenses @ 18% IGST""Travelling Expenses - Domestic""Travelling Expenses - Foreign""Travelling Expenses GST @ 12%""Travelling Expenses - Local @ 12%""Travelling Expenses - Local IGST @ 5%""TRICOG HEALTH INDIA PRIVATE LIMITED""TRINETRI FARMS""Trinity Car Care Pvt.Ltd""Triphase Technologies (P) Ltd""TROIKA ENGINEERING SOLUTIONS""TRUSTED SERVICES""Tuition Fees""Turbo India Interconnect Solutions LLP - Cable Harn""Tvasta Id India Pvt Ltd""T V Deshikan""TVS Jupiter""TVS - XL""Ujjwal Systems""ULTRAVIOLETTE AUTOMOTIVE PRIVATE LIMITED""Unified Electro-Tech Pvt. Ltd.""UNIMECH AEROSPACE & MANUFACTURING PVT LTD""Union Bank MF 69346""Union Bank MF 8764""Union Bank MF 8916825""Union Bank of India - Car Loan A/c6636 Hexa""Union Bank of India (Erstwhile Corporation Bank)""Union Bank of India Ertiga Loan 965364 R""Union Bank of India OD A/c""Union Bank of India SB A/c No.520101062409170 R""Unique Punch System Pvt Ltd""United Telecoms Ltd""UNITEK ENTERPRISES""University of Agricultural Science""UPS Express Pvt. Ltd.""U.R. RAO Satellite Centre""URS CERTIFICATION LTD""USD Purchase""Usha ND""V3 Novus Private Limited""V5 Semiconductors""Vaccum Techniques Pvt Ltd""Vacus Tech Pvt Ltd""Vaidyuthi Mobility Pvt Ltd ""VANI PRIVATE LIMITED""Vani Private Limited (HEBBAL)""Varun Specialities""Vat 13.5% Tax""Vat 14% Tax""Vat 14.5% Tax""Vat 5% Tax""Vat 5.5% Tax""VCB Electronics Pvt LTD""Vedant Synergy Private Limited-P""Veer-O-Metals Pvt Ltd.""Vehicle Insurance""Vehicle Insurance Claim""Vehicle Maintenance""Vehicle Maintenance @ 28%""Velankani Electronics PVT Ltd""VEM Technologies Pvt Ltd (Unit-II)""Venus Shipping Pvt. Ltd.""Versabyte Data Systems Private Limited""VGS Enterprises - P""Vibgyor Interiors""Vijayananda Travels Pvt. Ltd.""VIJAY ELECTRICALS""Vikram Sarabhai Space Centre""VINAYAKA TECHNOLOGIES""Vinayaka Tours & Travels""Vintus Systems - P""Vinyas Innovative Technologies Pvt Ltd""Vishal Electricals""Vishal Graphics""Vlink Systems Private Limited""VMX HI CONNECTORS PVT LTD""VMX HI CONNECTORS PVT . LTD-CHN""Volex Interconnect India Pvt Ltd""VPS Technologies""VR ENGINEERING WORKS""VRL LOGISTICS LIMITED""VRL Logistics Ltd""VS Electronics""V SUBHA RAO""Vvivid Vista""Waganr Car""Waganr Car Loan UBI A/c No.00004 R""Wall Style Interiors""Weg Ind.India Private Ltd""Welspun Solar AP Pvt Ltd""WELSPUN SOLAR PVT LTD""Williams Refrigeration""Wimate Technology Solutions Pvt Ltd""Wipro Enterprises ( P) LTD""WIPRO ENTERPRISES PVT LTD (3D)""Wipro Limited""WOLAX LIGHTINGS""World of River Pvt. Ltd.""WPF ENTERPRISES""Xl Energy Limited""Xtratek Electronics""YASHAS INFOTECH""Yokogawa India Limited""YSL ELECTRONICS""Zamil Industries Ltd""Zemith Trading Co""Zen Technologies Limited,""ZONJE SOLAR LLP""Zreyah Semiconductor Systems Pvt. Ltd."],
    "Retail": ["discount", "shopping mall", "grocery"]
}

# Optional: Known abbreviations map
abbreviations = {
    "cc": "credit card",
    "med": "medical",
    "doc": "doctor",
}

# ---------------------------
# 2. Build Aho-Corasick Automaton for exact matches
# ---------------------------
A = ahocorasick.Automaton()
keyword_to_category = {}

for category, words in keywords.items():
    for word in words:
        word_lower = word.lower()
        A.add_word(word_lower, (word_lower, category))
        keyword_to_category[word_lower] = category

A.make_automaton()

# ---------------------------
# 3. Preprocessing helper
# ---------------------------
def preprocess(text):
    text = text.lower()
    text = re.sub(r'[^a-z0-9\s]', '', text)
    tokens = text.split()
    # Expand known abbreviations
    expanded_tokens = [abbreviations.get(tok, tok) for tok in tokens]
    return " ".join(expanded_tokens), expanded_tokens

# ---------------------------
# 4. Enhanced Matching Function
# ---------------------------
def match_keywords(sentence, fuzzy_threshold=85):
    text, tokens = preprocess(sentence)

    matches = defaultdict(list)
    scores = defaultdict(float)

    # Step 1: Exact & multi-word match via Aho-Corasick
    for end_idx, (kw, category) in A.iter(text):
        matches[category].append((kw, 100))
        scores[category] += 1.0

    # Step 2: Fuzzy matching for spelling mistakes & partial matches
    for token in tokens:
        for kw, category in keyword_to_category.items():
            score = fuzz.ratio(token, kw)
            if score >= fuzzy_threshold:
                matches[category].append((token, score))
                # Weight fuzzy matches lower than exact
                scores[category] += score / 120

    # Step 3: Partial match scoring (substrings)
    for token in tokens:
        for kw, category in keyword_to_category.items():
            if token in kw and token != kw:
                matches[category].append((token, 60))  # partial match weight
                scores[category] += 0.5

    # Step 4: Compute weighted relevance score
    relevance = {
        cat: round(score / len(keywords[cat]), 2)
        for cat, score in scores.items()
    }

    return matches, relevance

# ---------------------------
# 5. Test the enhanced function
# ---------------------------
sentence = "Show me the account balance for WPF Enterprise"
matches, relevance = match_keywords(sentence)

print("Matches by category:", dict(matches))
print("Category relevance scores:", relevance)


# ---------------------------
